.row
  .col-md-6.offset-md-3
    = form_for(rsvp, url: rsvp_path(rsvp), local: true) do |f|
      - if rsvp.errors.any?
        %p errors
        %ul
          - rsvp.errors.full_messages.each do |msg|
            %li= msg
      %fieldset.form-group
        %legend= rsvp.name
        = f.label :dietary, 'Do you have any dietary requirements?'
        = f.text_field :dietary, class: 'form-control'

        = f.label :attending, 'Can you attend?'
        = f.check_box :attending

        - rsvp.number_of_guests.times do |guest_number|
          %fieldset.form-group
            %legend= "Guest #{guest_number + 1}"
            = f.fields_for :guests, rsvp.guests do |ff|
              = ff.label :name
              = ff.text_field :name, disabled: !ff.object.name_updatable?, readonly: !ff.object.name_updatable?, class: 'form-control'

              = ff.label :dietary, 'Does your guest have any dietary requirements?'
              = ff.text_field :dietary, class: 'form-control'

              = ff.label :attending, 'Can they attend?'
              = ff.check_box :attending
        = f.submit 'Submit your RSVP', class: 'btn btn-primary'
